<!-- Minimal local decoders for Harbor / Metasploit / Mitmproxy / Trivy -->
<!-- POSIX regex (usa [[:space:]] etc.), sem comentÃ¡rios abertos -->

<!-- Harbor JSON decoders -->
<decoder name="harbor-core-json">
  <prematch>harbor-core </prematch>
  <plugin_decoder>JSON_Decoder</plugin_decoder>
</decoder>

<decoder name="harbor-jobservice-json">
  <prematch>harbor-jobservice </prematch>
  <plugin_decoder>JSON_Decoder</plugin_decoder>
</decoder>

<decoder name="trivy-adapter-json">
  <prematch>harbor-trivy </prematch>
  <plugin_decoder>JSON_Decoder</plugin_decoder>
</decoder>

<!-- Metasploit: console audit plain text -->
<decoder name="metasploit-audit">
  <prematch>metasploit</prematch>
  <regex>^[^[:space:]]+[[:space:]][0-9]+[[:space:]][0-9]{2}:[0-9]{2}:[0-9]{2}[[:space:]][^[:space:]]+[[:space:]]metasploit[[:space:]](.*)$</regex>
  <order>program_name</order>
</decoder>

<!-- Mitmproxy: JSON payload (se o payload for JSON) -->
<decoder name="mitmproxy-json">
  <prematch>mitmproxy </prematch>
  <plugin_decoder>JSON_Decoder</plugin_decoder>
</decoder>

<!-- Mitmproxy: capture tudo que vem depois do programname (mensagem livre; cobre casos com timestamp extra) -->
<decoder name="mitmproxy-audit">
  <prematch>mitmproxy</prematch>
  <regex>^[^[:space:]]+[[:space:]][0-9]+[[:space:]][0-9]{2}:[0-9]{2}:[0-9]{2}[[:space:]][^[:space:]]+[[:space:]]mitmproxy[[:space:]](.*)0/regex>
  <order>message</order>
</decoder>

<!-- Mitmproxy: fallback robusto que encontra MITM-XXXXX em qualquer lugar e captura id+resto -->
<decoder name="mitmproxy-audit-raw">
  <prematch>MITM</prematch>
  <regex>^.*(MITM-[A-Z0-9-]+)[[:space:]]*(.*)0/regex>
  <order>id,message</order>
</decoder>
